Ext.ns("SS");Ext.ns("SS.settings");Ext.ns("SS.settings.stores");Ext.ns("SS.settings.StorePages");Ext.ns("SS.settings.providers");Ext.ns("SS.data");Ext.ns("SS.fields");Ext.ns("SS.admin");Ext.ns("SS.orders");Ext.ns("SS.products");Ext.ns("SS.charts");Ext.ns("SS.customers");Ext.ns("SS.ship");Ext.ns("SS.fill");Ext.ns("SS.po");Ext.Ajax.defaultHeaders={Accept:"application/json"};function DateFormat(a){if(!a)return"";a=a.replace(/\/Date\((\d+)\)\//g,function(c,b){try{var a=new Date(parseInt(b));return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()}catch(f){}return b});return a}Ext.define("SS.helper",{statics:{GetScaleWeight:function(a,b){Ext.Ajax.request({url:"http://127.0.0.1:33785/scale.xml",cors:true,success:function(d){var c=Ext.decode(d.responseText);if(c.oz=="777")Ext.Msg.alert("Unable to Read!","DeviceStation was unable to read a valid weight from your scale.  Please ensure that your scale is plugged in to your computer and turned on.");else a.call(b,c.lbs,c.oz)},failure:function(){Ext.Msg.alert("Unable to Read!","An error occurred while trying to contact SyncStation.  Please ensure that it is installed and running on your computer.")}})},SendPrintJob:function(c,f,e,g,d,h,a,b){Ext.Ajax.request({url:"http://127.0.0.1:33786/print.xml",headers:{durl:c},params:{orderIds:f,shipments:e,batch:g,scanforms:d,ids:h,FQZ:"1"},method:"POST",scope:this,cors:true,success:function(d){var c=Ext.decode(d.responseText);if(c.result!="success")a.call(b,"ShipStation was unable to connect to SyncStation. Details: "+c.result);else a.call(b,c.result)},failure:function(){a.call(b,"An error occurred while trying to contact SyncStation.  Please ensure that it is installed and running on your computer.")}})},PingDevice:function(a,b){Ext.Ajax.request({url:"http://127.0.0.1:33786/print.xml",method:"GET",scope:this,cors:true,success:function(d){var c=Ext.decode(d.responseText);if(c.result!="success")a.call(b,"ShipStation was unable to connect to SyncStation. Details: "+c.result);else a.call(b,c.result)},failure:function(){a.call(b,"An error occurred while trying to contact SyncStation.  Please ensure that it is installed and running on your computer.")}})},callbackJayro:function(){},SortEncoder:function(d){for(var e=d.length,c=[],b,a=0;a<e;a++){b=d[a];c[a]=b.property+"#"+b.direction}return c.join("|")},TrackShipments:function(b,c,e){if(!_settings.CanShip&&!_settings.CanFulfill){Ext.Msg.alert("No Providers Configured",'You have not yet setup a shipping provider to purchase postage and print labels.  Please visit your <a href="'+SS.url.app+'settings/providers">settings</a> to configure your preferred provider(s).');return}for(var d=[],a=0;a<b.length;a++)b[a].data.TrackingNumber&&b[a].data.Voided===false&&d.push({ProviderId:b[a].data.ProviderID,ShippingId:b[a].data.ShipmentID,SellerId:b[a].data.SellerID,PicNumber:b[a].data.TrackingNumber});Ext.Ajax.request({url:SS.url.app+"ship/TrackPackages",method:"post",jsonData:d,scope:this,timeout:1.8e5,success:function(a){var b=Ext.decode(a.responseText);c&&c.call(e,true,b)},failure:function(){c.call(e,false)}})},UpdateOrderRates:function(a,c,e){if(!_settings.CanShip&&!_settings.CanFulfill){Ext.Msg.alert("No Providers Configured",'You have not yet setup a shipping provider to purchase postage and print labels.  Please visit your <a href="'+SS.url.app+'settings/providers">settings</a> to configure your preferred provider(s).');return}for(var d=[],b=0;b<a.length;b++){var f=a[b].data;a[b].set("UpdatingRate",true);Ext.apply(f,a[b].getAssociatedData());d.push(f)}Ext.Ajax.request({url:SS.url.app+"ship/updaterates",method:"post",jsonData:d,scope:this,timeout:1.8e5,success:function(g){var f=Ext.decode(g.responseText);if(f.orders)for(var d=0;d<f.orders.length;d++){var b=a[d].store.getById(f.orders[d].OrderID);if(!b)continue;b.beginEdit();b.set("UpdatingRate",false);b.set("ShippingCost",f.orders[d].ShippingCost);b.set("InsuranceCost",f.orders[d].InsuranceCost);b.set("ConfirmationCost",f.orders[d].ConfirmationCost);b.set("OtherCost",f.orders[d].OtherCost);b.set("RateError",f.orders[d].RateError);b.endEdit();b.commit()}c&&c.call(e,true,a)},failure:function(){for(var b=0;b<a.length;b++)a[b].set("UpdatingRate",false);c.call(e,false)}})},PrintPreview:function(b){var a=Ext.getBody().getViewSize(),c=new Ext.window.Window({modal:true,height:a.height-100,width:a.width-100,style:"border:solid 2px #94ae0a",layout:"fit",url:b,preventHeader:true,draggable:false,resizable:false,closable:false,tbar:["->",{text:'<b style="font-size:1.2em">Print Document(s)</b>',icon:SS.url.app+"icons/printButton.png",scale:"medium",itemId:"btnPrint",disabled:!Ext.isIE,handler:function(a){a.up("window").down("#docframe").el.down("iframe").dom.contentWindow.print()}},"-",{text:'<b style="font-size:1.2em">Save Document</b>',scale:"medium",icon:SS.url.app+"icons/save24.png",handler:function(a){var b=a.up("window");location.href=b.url+"&download=1"}},"-",{text:'<b style="font-size:1.2em">Close</b>',scale:"medium",icon:SS.url.app+"icons/close24.png",handler:function(c){var a=c.up(".window"),b=a.down("#docframe").el.down("iframe").dom;b.src="javascript:false";a.close()}},"->",{xtype:"checkbox",boxLabel:"<b>Always preview downloaded documents</b>",hideLabel:true,inputValue:"true",uncheckedValue:"false",checked:_settings.PdfInBrowser==="true",margin:"0 16 0 0",handler:function(a){!Ext.isIE&&!a.checked&&Ext.Msg.alert("Preview Disabled","If you would like to turn on the PDF preview window again, you can do so from your 'Profile' by clicking your name at the top/right corner of ShipStation.");_settings.PdfInBrowser=a.checked.toString();Ext.Ajax.request({url:SS.url.app+"profile/savesetting",method:"post",params:{name:"PdfInBrowser",value:a.checked}})}}],items:[{itemId:"downloading",hidden:true,layout:{type:"vbox",align:"center",pack:"center"},items:[{xtype:"box",html:'<h2 class="title">Loading...</h2><img src="'+SS.url.app+'images/wait_bar.gif">',style:"text-align:center"}]},{itemId:"docframe",border:false,html:'<iframe border="0" frameBorder="0" src=\''+b+"'>",listeners:{afterrender:function(a){var c=a.el.down("iframe"),b=a.up("window");b.down("#docframe").setLoading({cls:"mask-plain",msg:'<img src="'+SS.url.app+'images/wait_bar.gif">'});c.on("load",function(){this.down("#docframe").setLoading(false);this.down("#btnPrint").setDisabled(false)},b)},afterlayout:function(a){var b=a.el.down("iframe");b.setStyle("width",a.el.getStyle("width"));b.setStyle("height",a.el.getStyle("height"))}}}]});c.show()}}});Ext.apply(Ext.form.field.VTypes,{daterange:function(e,a){var b=a.parseDate(e);if(!b)return false;if(a.startDateField&&(!this.dateRangeMax||b.getTime()!=this.dateRangeMax.getTime())){var c=a.up("form").down("#"+a.startDateField);c.setMaxValue(b);c.validate();this.dateRangeMax=b}else if(a.endDateField&&(!this.dateRangeMin||b.getTime()!=this.dateRangeMin.getTime())){var d=a.up("form").down("#"+a.endDateField);d.setMinValue(b);d.validate();this.dateRangeMin=b}return true},daterangeText:"Start date must be less than end date",password:function(c,a){if(a.initialPassField){var b=a.up("form").down("#"+a.initialPassField);return c==b.getValue()}return true},differ:function(c,a){if(a.otherField){var b=a.up("form").down("#"+a.otherField);return!(c==b.getValue())}return true},passwordText:"Values cannot be the same",passwordText:"Passwords do not match",phoneNo:function(a){return/^\d\d\d-\d\d\d-\d\d\d\d$/.test(a)},phoneNoText:"Please enter phone number in the format 'xxx-xxx-xxxx'"});Ext.ux.PersistentTip=Ext.extend(Ext.ToolTip,{initComponent:function(){Ext.apply(this,{autoHide:false});this.callParent()},getTargetXY:function(){var a=Ext.ux.PersistentTip.superclass.getTargetXY.call(this);if(this.offset){a[0]+=this.offset[0];a[1]+=this.offset[1]}return a},afterRender:function(){Ext.ux.PersistentTip.superclass.afterRender.call(this);this.el.on("mouseout",this.onTargetOut,this);this.el.on("mouseover",this.onElOver,this)},checkWithin:function(a){return this.el&&a.within(this.el.dom,true)?true:this.disabled||a.within(this.target.dom,true)?true:false},onElOver:function(a){this.checkWithin(a)&&this.clearTimer("hide")},onTargetOver:function(a){if(this.disabled||a.within(this.target.dom,true))return;this.clearTimer("hide");this.targetXY=this.getTargetXY();this.show()},delayShow:function(a){this.showTimer=this.doShow.defer(this.showDelay,this,[a])},doShow:function(c){var a=c.getXY(),b=this.target.getRegion().contains({left:a[0],right:a[0],top:a[1],bottom:a[1]});b&&this.show()},onTargetOut:function(a){if(this.checkWithin(a)||this.dontHide)this.clearTimer("hide");else if(this.hideTimer)this.hide();else this.delayHide()}});Ext.override(Ext.Component,{stateful:false,initComponent:function(){if(this.demand)if(!Ext.get("x"+this.demand.replace(/\-/gi,"")))this.hidden=true;if(this.feature)this.hidden=this.hidden||!((permiso&Math.pow(2,this.feature))==Math.pow(2,this.feature));if(this.sellerSetting&&_settings)if(!_settings[this.sellerSetting]||_settings[this.sellerSetting]!="true")this.hidden=true;if(this.noFeature)this.hidden=this.hidden||(permiso&Math.pow(2,this.noFeature))==Math.pow(2,this.noFeature);this.callParent()},listeners:{beforeshow:function(a){if(a.demand)if(!Ext.get("x"+a.demand.replace(/\-/gi,"")))return false;if(a.sellerSetting)if(_settings)if(!_settings[a.sellerSetting]||_settings[a.sellerSetting]!="true")return false;var b=true;if(a.feature)b=(permiso&Math.pow(2,this.feature))==Math.pow(2,this.feature);if(a.noFeature)b=b&&(permiso&Math.pow(2,this.noFeature))!=Math.pow(2,this.noFeature);return b}}});Ext.override(Ext.menu.Menu,{doConstrain:function(){var a=this,e=a.el.getY(),b,c,i,h=e,g,f,j,d;c=a.getHeight();delete a.height;a.setSize();if(a.floating){f=Ext.fly(a.el.dom.parentNode);j=f.getScroll().top;d=f.getViewSize().height;g=e-j;b=a.maxHeight?a.maxHeight:d-g;if(c>d){b=d;h=e-g}else if(b<c){h=e-(c-b);b=c}}else b=a.getHeight();if(a.maxHeight)b=Math.min(a.maxHeight,b);if(c>b&&b>0){a.layout.autoSize=false;a.setHeight(b);a.showSeparator&&a.iconSepEl.setHeight(a.layout.getRenderTarget().dom.scrollHeight)}i=a.getConstrainVector(a.el.dom.parentNode);i&&a.setPosition(a.getPosition()[0]+i[0]);a.el.setY(h)}});Ext.dd.DragDropManager.clickPixelThresh=10;Ext.dd.DragDropManager.clickTimeThresh=500;Ext.override(Ext.selection.CheckboxModel,{onRowMouseDown:function(g,e,j,i,b){g.el.focus();var a=this,h=b.getTarget(),c=false,d=Ext.get(b.getTarget());if(d==null)return;if(d.is("."+Ext.baseCSSPrefix+"grid-row-checker")||d.down("."+Ext.baseCSSPrefix+"grid-row-checker"))c=true;if(a.checkOnly&&!c)return;if(c){var f=a.getSelectionMode();f!=="SINGLE"&&a.setSelectionMode("SIMPLE");a.selectWithEvent(e,b);a.setSelectionMode(f)}else a.selectWithEvent(e,b)}});Ext.override(Ext.data.proxy.Ajax,{doRequest:function(b,c,d){var e=this.getWriter(),a=this.buildRequest(b,c,d);if(b.allowWrite())a=e.write(a);Ext.apply(a,{headers:this.headers,timeout:this.timeout,scope:this,callback:this.createRequestCallback(a,b,c,d),method:this.getMethod(a),disableCaching:false});this.lastRequest=Ext.Ajax.request(a);return a}});Ext.override(Ext.EventObjectImpl,{correctWheelDelta:function(a){var c=this.WHEEL_SCALE,b=Math.round(a/c);if(!b&&a)b=a<0?-1:1;return b}});Ext.define("Ext.chart.theme.gauge",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#94ae0a","#fff"],axis:{stroke:"#ccc",fill:"#ccc"},axisLabelBottom:{fill:"#ccc"}},a)])}});Ext.define("Ext.chart.theme.manyColors",{extend:"Ext.chart.theme.Base",constructor:function(a){this.callParent([Ext.apply({colors:["#6dc289","#f06127","#64b6cc","#dddd4b","#bbb8b3","#6b4c6c","#831c2d","#f2d450","#125ca7"]},a)])}});function demand(a){return!(Ext.get("x"+a.replace(/\-/gi,""))==null)}function hasFeature(a){return(permiso&Math.pow(2,a))==Math.pow(2,a)}Ext.define("SS.helper.PasteAddress",{extend:"Ext.window.Window",parse:function(a){this.setLoading("Parsing Address");Ext.Ajax.request({url:SS.url.app+"orders/parseaddress",params:{text:a},scope:this,success:function(b){this.setLoading(false);var a=Ext.decode(b.responseText);if(a.success){var c={ShipName:a.result.FullName,ShipCompany:a.result.Company,ShipStreet1:a.result.Address1,ShipStreet2:a.result.Address2,ShipCity:a.result.City,ShipCountryCode:a.result.Country,ShipPostalCode:a.result.PostalCode,ShipState:a.result.State};this.fireEvent("addressparsed",c);this.close()}else{this.setLoading(false);Ext.Msg.alert("Couldn't Parse","Unfortunately the address couldn't be parsed.  Double check the address and try again")}}})},initComponent:function(){Ext.apply(this,{title:"Paste a US Address",autoHeight:true,width:300,modal:true,items:[{border:false,bodyPadding:8,xtype:"form",items:[{border:false,html:"Paste a full US address in the box below and we'll<br/>attempt to parse out the address fields for you<br/><br/>"},{xtype:"textarea",height:140,anchor:"100%",hideLabel:true,itemId:"address"}]}],buttonAlign:"left",buttons:[{text:"Cancel",scope:this,handler:function(){this.close()}},"->",{text:"<b>Parse Address</b>",scope:this,handler:function(){var a=this.down("#address").getValue();this.parse(a)}}]});this.callParent()}});if(!Ext.grid.View.prototype.templates)Ext.grid.View.prototype.templates={};Ext.grid.View.prototype.templates.cell=new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} x-selectable {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="x-grid3-cell-inner x-grid3-col-{id}" {attr}>{value}</div>',"</td>");Ext.selection.CheckboxModel.override({initEvents:function(){Ext.selection.CheckboxModel.superclass.initEvents.call(this);(this.grid.enableDragDrop||this.grid.enableDrag)&&this.grid.events.rowclick.clearListeners();this.grid.on("afterrender",function(){var a=this.grid.getView();a.mainBody.on("mousedown",this.onMouseDown,this);Ext.fly(a.innerHd).on("mousedown",this.onHdMouseDown,this)},this)},handleMouseDown:function(){var d=0}});Ext.view.DragZone.override({handleMouseDown:function(a){if(a.target.className=="x-grid-row-checker"&&this.view){var d=this.view.findItemByChild(a.target),b=this.view.getRecord(d),c=this.view.getSelectionModel();if(c.isSelected(b)){c.deselect(b);a.target=null;a.stopEvent();return false}}Ext.view.DragZone.superclass.handleMouseDown.apply(this,arguments)}});Ext.define("SS.helper.CheckDragPlugin",{alias:"plugin.checkdragplugin",extend:"Ext.grid.plugin.DragDrop",initComponent:function(){this.callParent()},onViewRender:function(){var a=this;a.callParent(arguments);a.dragZone.setPadding(0,0,0,-30);a.dragZone.invalidHandleClasses=["x-grid-row-checker"];a.dragZone.onMouseDown=function(){return false}}});Ext.define("SS.helper.PrintButton",{extend:"Ext.button.Split",alias:"widget.printbutton",defaultPrinter:null,initComponent:function(){var e=null;if(!_settings)return;var c=_settings.LocalPrinting=="true",a=[];if(this.printers&&this.printers.length>0||c){for(var b=0;b<this.printers.length;b++){var d=this.printers[b].name;if(this.defaultPrinter&&printers[b].id==this.defaultPrinter)d="<b>"+d+" (default)</b>";a.push({text:d,printer:this.printers[b].id,icon:SS.url.app+"icons/print16.png"})}if(c){this.printers&&this.printers.length>0&&a.push("-");if(this.defaultPrinter)a.push({text:"Send to Local Printer...",printer:"DeviceStation",icon:SS.url.app+"icons/gear16.png"});else a.push({text:"<b>Send to Local Printer... (default)</b>",printer:"DeviceStation",icon:SS.url.app+"icons/gear16.png"})}a.push("-");if(this.defaultPrinter||c)a.push({text:"Download PDF...",icon:SS.url.app+"icons/pdf16.png"});else a.push({text:"<b>Download PDF... (default)</b>",icon:SS.url.app+"icons/pdf16.png"});e=new Ext.menu.Menu({items:a,listeners:{scope:this,click:function(b,a){this.fireEvent("print",a.printer,a)}}})}Ext.apply(this,{menu:e,scope:this,handler:function(){if(_settings.LocalPrinting=="true")this.fireEvent("print","DeviceStation",this);else if(this.defaultPrinter&&this.printers.length>0)this.fireEvent("print",this.defaultPrinter,this);else if(this.printers.length>0)this.showMenu();else this.fireEvent("print",null,this)}});a.length==0&&_settings.LocalPrinting!="true"&&this.addCls("no-split");this.callParent()}});Ext.define("SS.helper.PrintMenuItem",{extend:"Ext.menu.Item",alias:"widget.printmenuitem",defaultPrinter:null,initComponent:function(){var e=null;if(!_settings)return;var c=_settings.LocalPrinting=="true",a=[];if(this.printers&&this.printers.length>0||c){for(var b=0;b<this.printers.length;b++){var d=this.printers[b].name;if(this.defaultPrinter&&printers[b].id==this.defaultPrinter)d="<b>"+d+" (default)</b>";a.push({text:d,printer:this.printers[b].id,icon:SS.url.app+"icons/print16.png"})}if(c){this.printers&&this.printers.length>0&&a.push("-");if(this.defaultPrinter)a.push({text:"Send to Local Printer...",printer:"DeviceStation",icon:SS.url.app+"icons/gear16.png"});else a.push({text:"<b>Send to Local Printer... (default)</b>",printer:"DeviceStation",icon:SS.url.app+"icons/gear16.png"})}a.push("-");if(this.defaultPrinter||c)a.push({text:"Download PDF...",icon:SS.url.app+"icons/pdf16.png"});else a.push({text:"<b>Download PDF... (default)</b>",icon:SS.url.app+"icons/pdf16.png"});e=new Ext.menu.Menu({items:a,listeners:{scope:this,click:function(b,a){this.fireEvent("print",a.printer,a)}}})}Ext.apply(this,{menu:e,scope:this,handler:function(){if(this.printers.length>0)this.showMenu();else this.fireEvent("print",null,this)}});a.length==0&&_settings.LocalPrinting!="true"&&this.addCls("no-split");this.callParent()}});lightbox=function(b){var a=new Ext.window.Window({modal:true});a.update('<img src="'+b+'">');a.show()};SS.helper.Alerts=Ext.extend(Ext.window.Window,{initComponent:function(){Ext.apply(this,{modal:true,title:"Alerts",closeAction:"hide",height:400,width:500,layout:"fit",items:[{autoScroll:true,loader:{renderer:"data",loadMask:{msg:"Please wait..."},autoLoad:true,url:SS.url.app+"settings/getselleralerts"},tpl:["<div id='selleralerts'>",'<tpl for=".">',"<div class='selleralert'>",'<a href="javascript:;" class="delete" onclick="dismissAlert(\'{ReplaceKey}\',Ext.get(this).up(\'div\'))"></a>','<img src="'+SS.url.app+'icons/alert24.gif" height="24" width="24" />','<div class="message">',"{Content}","</div>",'<div style="clear:both"></div>',"</div>","</tpl>","</div>"]}]});this.callParent()}});Ext.define("SS.helper.Help",{extend:"Ext.window.Window",questionClick:function(a){this.expandAnswer(a.target)},expandAnswer:function(b){var a=Ext.get(b);if(a.is(".selected")){a.next("div.answer").setDisplayed("none");a.removeCls("selected")}else{Ext.Array.each(this.el.query("div.answer"),function(a){Ext.get(a).setDisplayed("none")});Ext.Array.each(this.el.query("a.title"),function(a){Ext.get(a).removeCls("selected")});a.next("div.answer").setDisplayed("block");a.addCls("selected")}},initComponent:function(){Ext.apply(this,{layout:"fit",border:false,style:"background-color:white; border:solid 2px #94ae0a",items:[{itemId:"content",html:'<div style="padding:180px; text-align:center; font-size:1.4em; font-weight:bold; font-style:italic; color:#404040;">Loading...</div>',border:false,loader:{renderer:"data",loadMask:{msg:"Loading..."},autoLoad:false},autoScroll:false,tpl:['<div class="faq" style="">','<div class="header"><a href="javascript:;" class="close" onclick="SS.helper.Help.close(); return false;"></a>Help and Frequent Questions</div>','<tpl if="articles">','<div class="articles">','<tpl if="success">','<tpl for="articles">','<a class="title" answer="{id}" href="javascript:;">{subject}</a>','<div class="answer" id="answer{id}" style="display:none">{main_content}</div>',"</tpl>","</tpl>",'<tpl if="!success">','<div class="answer"><i>This help article could not be found!</i></div>',"</tpl>","</div>","</tpl>",'<tpl if="!articles">','<div style="padding:150px; text-align:center; font-size:1.4em;  line-height:1.4em; font-weight:bold; font-style:italic; color:#404040;">We\'re sorry, but an error occurred attempting to load the help article.</div>',"</tpl>","</div>"]}],height:480,width:640,modal:true,preventHeader:true,draggable:false,closable:false});this.callParent();this.down("#content").getLoader().on("load",function(d){for(var c=d.target.el.query("a"),a=0;a<c.length;a++)Ext.get(c[a]).set({target:"_blank"});this.center();for(var b=d.target.el.query("a.title"),a=0;a<b.length;a++)Ext.get(b[a]).on("click",this.questionClick,this);b.length==1&&this.expandAnswer(b[0])},this,{delay:30})},statics:{active:undefined,show:function(c,b){var a=new SS.helper.Help;a.down("#content").getLoader().load({url:SS.url.app+"settings/gethelparticles",params:{ids:c},callback:function(b,a){!a&&b.target.update({articles:false})}});a.show(b);SS.helper.Help.active=a},close:function(){SS.helper.Help.active&&SS.helper.Help.active.close()}}});SS.helper.IntegrationStatus=Ext.extend(Ext.window.Window,{initComponent:function(){Ext.apply(this,{height:400,width:500,modal:true,layout:"fit",title:"Integration Statuses",items:[{autoScroll:true,bodyPadding:8,loader:{url:SS.url.app+"settings/integrationstatus",autoLoad:true,renderer:"data",listeners:{load:function(a){a.target.el.down(".update-list").setVisibilityMode(Ext.Element.DISPLAY);a.target.el.down(".update-list").hide()}}},tpl:['<div class="integrationstatus">','<tpl for="statuses">','<h2 class="title">{Type}</h2>','<tpl for="Partners">',"<div class=\"partnerStatus {[values.StartTime ? 'error' : '']}\">",'<div class="logo">',"<tpl if=\"parent.Type == 'Marketplaces'\">",'<img src="'+SS.url.app+'images/marketplace/{Name}.jpg">',"<tpl else>",'<img src="'+SS.url.app+'images/provider/m/{Name}.png">',"</tpl>","</div>",'<div class="statusDetails">','<tpl if="!StartTime">','<div class="status"><img src="'+SS.url.app+'icons/check24.png" align="absmiddle"> Operating Normally</div>',"<tpl else>",'<div class="status"><img src="'+SS.url.app+'icons/cancel24.png" align="absmiddle"> Service Interruption!</div>',"<div style=\"color:#999; margin-left:30px;\">First detected {[Ext.Date.format(Ext.Date.parse(values.StartTime, 'MS'),'n/d/y g:i A')]} (PT)</div>","</tpl>","</div>",'<tpl if="Statuses">','<div class="updates">','<a href="javascript:;" class="update-toggle"><b>{Statuses.length}</b> status update(s)</a>','<div class="update-list">','<tpl for="Statuses">','<div class="update">',"<b>{[Ext.Date.format(Ext.Date.parse(values.Posted, 'MS'),'n/d/y g:i A')]} (PT)</b><br>","{Message}","</div>","</tpl>","</div>","</div>","</tpl>","</div>","</tpl>","</tpl>","</div>"],listeners:{afterRender:function(a){a.el.on("click",function(c,b){Ext.get(b).is("a.update-toggle")&&a.el.down(".update-list").toggle()})}}}]});this.callParent()}});SS.settings.Warehouse=Ext.extend(Ext.Window,{constructor:function(a){this.record=a;SS.settings.Warehouse.superclass.constructor.call(this)},initComponent:function(){Ext.applyIf(this,{title:"New Warehouse",modal:true,width:400,layout:"fit",items:[{border:false,xtype:"form",itemId:"whForm",bodyPadding:12,defaults:{labelWidth:120},items:[{xtype:"textfield",fieldLabel:"Warehouse Name",name:"Name",anchor:"96%"},{xtype:"textfield",fieldLabel:"Origin Zipcode",name:"OriginPostalCode",allowBlank:false,maxLength:10,enforceMaxLength:true,width:200},{xtype:"state_combo",fieldLabel:"Origin State",name:"OriginState",allowBlank:true,forceSelection:true,width:260},{xtype:"fieldset",title:"Return Address",defaults:{labelWidth:120,anchor:"96%"},items:[{xtype:"textfield",fieldLabel:"Return to Name",name:"ReturnName"},{xtype:"textfield",fieldLabel:"Return to Company",name:"ReturnCompany"},{xtype:"textfield",fieldLabel:"Return Address",name:"ReturnStreet1"},{xtype:"textfield",fieldLabel:" ",labelSeparator:"",name:"ReturnStreet2"},{xtype:"textfield",fieldLabel:" ",labelSeparator:"",name:"ReturnStreet3"},{xtype:"fieldcontainer",layout:"hbox",fieldLabel:"City, State Zip",items:[{xtype:"textfield",name:"ReturnCity",flex:1},{width:1,border:false},{xtype:"textfield",name:"ReturnState",allowBlank:false,width:40},{width:1,border:false},{xtype:"textfield",name:"ReturnPostalCode",allowBlank:false,maxLength:6,enforceMaxLength:true,width:50}]},{xtype:"combo",fieldLabel:"Return Country",name:"ReturnCountryCode",width:100,queryMode:"local",forceSelection:true,autoSelect:false,listWidth:160,triggerAction:"all",lastQuery:"",lazyInit:false,editable:false,typeAhead:false,allowBlank:false,displayField:"Name",valueField:"Code",emptyText:"Select...",store:SS.data.OrderStores.CountryStore},{xtype:"textfield",fieldLabel:"Return to Phone",name:"ReturnPhone",regex:/^\D*(\d\D*){10}$/,regexText:"Phone must contain exactly 10 digits (ex. XXX-XXX-XXXX)",allowBlank:false,blankText:"Phone must contain exactly 10 digits (ex. XXX-XXX-XXXX)"},{xtype:"displayfield",value:"<a href='javascript:;' style=\"font-size:0.9em\" onclick='SS.helper.Help.show([1002472], this);'>why is my phone # required?</a>",fieldLabel:"&nbsp",labelSeparator:""},{xtype:"checkbox",inputValue:"true",uncheckedValue:"false",name:"IsResidential",boxLabel:"This is a residential address",fieldLabel:"&nbsp;",labelSeparator:""}]}]}],buttonAlign:"left",buttons:[{text:"Cancel",scope:this,handler:function(){this.close()}},"->",{text:"Set as default",scope:this,itemId:"btnDefault",icon:SS.url.app+"icons/check.gif",handler:function(a){this.record.set("Default",true);this.setLoading("Saving Changes...");this.record.save({scope:this,success:function(b){this.setLoading(false);this.fireEvent("defaultset",b);a.setVisible(false)},failure:function(){this.setLoading(false);Ext.Msg.alert("error","An error occurred: "+op.error.statusText)}})}},{text:"<b>Save Changes</b>",icon:SS.url.app+"icons/save16.png",scope:this,handler:function(){if(!this.down("#whForm").getForm().isValid())return;this.setLoading("Saving Changes...");this.down("#whForm").getForm().updateRecord(this.record);this.record.save({scope:this,success:function(a){this.setLoading(false);this.fireEvent("recordSaved",a);this.close()},failure:function(b,a){this.setLoading(false);Ext.Msg.alert("error","An error occurred: "+a.error.statusText)}})}}]});this.callParent();if(!this.record){this.record=Ext.ModelManager.create({Name:"New Warehouse"},"Warehouse");this.on("show",function(){this.setLoading("Please Wait...");Ext.Ajax.request({scope:this,url:SS.url.app+"settings/CanAddWarehouse",success:function(b){this.setLoading(false);var a=Ext.decode(b.responseText);!a.success&&Ext.Msg.alert("Error",a.message,function(){this.close()},this)}})},this)}this.down("#btnDefault").setVisible(!this.record.data.Default&&!this.record.phantom);this.down("#whForm").getForm().loadRecord(this.record);this.setTitle(this.record.data.Name)}})